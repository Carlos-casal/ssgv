{# Import Modal #}
<div class="modal fade" id="importModal" tabindex="-1" role="dialog" aria-labelledby="importModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg" role="document">
        <div class="modal-content">
            <div class="modal-header bg-primary text-white">
                <h5 class="modal-title" id="importModalLabel">
                    <i class="fas fa-file-excel mr-2"></i>
                    Carga Masiva desde Excel
                </h5>
                <button type="button" class="close text-white" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <div class="alert alert-info">
                    <h6 class="alert-heading">
                        <i class="fas fa-info-circle mr-2"></i>
                        Instrucciones de Importación
                    </h6>
                    <ul class="mb-0">
                        <li>Descarga la plantilla Excel oficial haciendo clic en el botón de abajo</li>
                        <li>Rellena la plantilla con los datos de tus materiales</li>
                        <li><strong>Puedes pegar imágenes directamente en las celdas del Excel</strong></li>
                        <li>El sistema detectará automáticamente los códigos de barras existentes</li>
                        <li>Si un código de barras ya existe, se sumará el stock</li>
                        <li>Si es un código nuevo, se creará el material con su imagen</li>
                    </ul>
                </div>

                <div class="text-center mb-4">
                    <a href="{{ path('app_material_import_template') }}" class="btn btn-success btn-lg">
                        <i class="fas fa-download mr-2"></i>
                        Descargar Plantilla Excel
                    </a>
                </div>

                <hr>

                <h6 class="font-weight-bold mb-3">
                    <i class="fas fa-upload mr-2"></i>
                    Subir Archivo Completado
                </h6>

                <form method="post" action="{{ path('app_material_import_preview') }}" enctype="multipart/form-data">
                    <div class="form-group">
                        <label for="import_file">Selecciona el archivo Excel:</label>
                        <div class="custom-file">
                            <input type="file" 
                                   class="custom-file-input" 
                                   id="import_file" 
                                   name="import_file" 
                                   accept=".xlsx,.xls"
                                   required>
                            <label class="custom-file-label" for="import_file">Elegir archivo...</label>
                        </div>
                        <small class="form-text text-muted">
                            Formatos aceptados: .xlsx, .xls
                        </small>
                    </div>

                    <div class="alert alert-warning">
                        <i class="fas fa-exclamation-triangle mr-2"></i>
                        <strong>Nota:</strong> Después de subir el archivo, verás una vista previa de los cambios antes de confirmar la importación.
                    </div>

                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-dismiss="modal">
                            <i class="fas fa-times mr-2"></i>Cancelar
                        </button>
                        <button type="submit" class="btn btn-primary">
                            <i class="fas fa-eye mr-2"></i>Vista Previa
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>

<script>
// Update file input label with selected filename
document.getElementById('import_file').addEventListener('change', function(e) {
    var fileName = e.target.files[0].name;
    var label = e.target.nextElementSibling;
    label.textContent = fileName;
});
</script>
