<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Test Form - TinyMCE & Borders</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- Carga de Bootstrap 5 desde CDN para aislamiento total -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body {
            background-color: #f0f2f5;
            padding-top: 50px;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        .test-container {
            max-width: 850px;
            margin: auto;
            background: white;
            padding: 40px;
            border-radius: 15px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.05);
        }

        /* --- CSS FIXES SOLICITADOS --- */

        /* 1. Global TinyMCE Logo/Statusbar Fix */
        .tox-statusbar__branding,
        .tox-statusbar__path,
        .tox-throbber,
        .tox-promotion {
            display: none !important;
        }

        /* 2. Input Group "Cut-Corner" & Border Fix */
        .test-input-group {
            display: flex !important;
            width: 100% !important;
            overflow: visible !important; /* CRUCIAL: No cortar bordes externos ni sombras */
            position: relative !important;
        }

        .test-input-group .form-select {
            border-top-right-radius: 0 !important;
            border-bottom-right-radius: 0 !important;
            border-right: 0 !important;
            z-index: 2;
        }

        .test-input-group .btn {
            border-top-left-radius: 0 !important;
            border-bottom-left-radius: 0 !important;
            z-index: 1;
            padding-left: 15px;
            padding-right: 15px;
        }

        /* Asegurar que el borde izquierdo sea siempre visible */
        .test-input-group > .form-select:first-child {
            border-left: 1px solid #dee2e6 !important;
        }

        /* Mantener el foco visible y por encima */
        .test-input-group .form-select:focus {
            z-index: 5;
            position: relative;
        }
    </style>
</head>
<body>
    <div class="test-container">
        <h1 class="h3 mb-4 text-primary border-bottom pb-3">Entorno de Pruebas Aislado</h1>

        <div class="row mb-5">
            <h5 class="mb-3 text-secondary">1. Verificación de Bordes (Input Groups)</h5>
            <div class="col-md-6 mb-3">
                <label class="form-label small fw-bold">Tipo de Servicio</label>
                <div class="input-group test-input-group">
                    <select class="form-select">
                        <option>Preventivo</option>
                        <option>Emergencia</option>
                    </select>
                    <button class="btn btn-primary" type="button">+ Nuevo</button>
                </div>
            </div>
            <div class="col-md-6 mb-3">
                <label class="form-label small fw-bold">Categoría</label>
                <div class="input-group test-input-group">
                    <select class="form-select">
                        <option>Terrestre</option>
                        <option>Acuático</option>
                    </select>
                    <button class="btn btn-primary" type="button">+ Nuevo</button>
                </div>
            </div>
        </div>

        <hr class="mb-5">

        <div class="mb-5">
            <h5 class="mb-3 text-secondary">2. Aislamiento de TinyMCE</h5>

            <div class="mb-4">
                <label for="test_tasks" class="form-label small fw-bold">Tareas (Debe ser Plain Text)</label>
                <textarea id="test_tasks" name="tareas" class="form-control" rows="3">Este campo NO carga TinyMCE. Es un simple cuadro de texto con rows="3".</textarea>
            </div>

            <div class="mb-4">
                <label for="test_description" class="form-label small fw-bold">Descripción (Debe cargar TinyMCE)</label>
                <textarea id="test_description" name="descripcion" class="form-control">Este campo SÍ carga TinyMCE en Español, sin barra de menús y sin branding.</textarea>
            </div>
        </div>

        <div class="d-flex justify-content-between align-items-center mt-5">
            <span class="text-muted small">Estado: Verificando fixes de UI</span>
            <a href="/" class="btn btn-outline-secondary btn-sm">Regresar</a>
        </div>
    </div>

    <!-- TinyMCE desde CDN para evitar problemas de dependencias locales -->
    <script src="https://cdn.tiny.cloud/1/no-api-key/tinymce/6/tinymce.min.js" referrerpolicy="origin"></script>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Inicialización dirigida EXCLUSIVAMENTE al ID solicitado
            tinymce.init({
                selector: '#test_description',
                language: 'es',
                menubar: false,
                statusbar: false,
                branding: false,
                promotion: false,
                plugins: 'advlist autolink lists link image charmap preview anchor pagebreak',
                toolbar: 'bold italic | bullist numlist | removeformat',
                height: 250,
                content_style: 'body { font-family: sans-serif; font-size: 14px; }'
            });

            console.log('Test Page Loaded');
            if (tinymce.get('test_tasks')) {
                console.error('ERROR: TinyMCE se cargó en Tareas.');
            } else {
                console.log('SUCCESS: Tareas es texto plano.');
            }
        });
    </script>
</body>
</html>
